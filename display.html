<!-- display.html (更新後) -->
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>OBS Telop Display</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="telop-container" class="telop-container">
        <div class="bottom-bar">
            <div id="telop-header" class="bottom-bar-header"></div>
            <div class="bottom-bar-content">
                <!-- ▼▼▼ 長体処理用の親要素と、各テキスト用のspanを配置 ▼▼▼ -->
                <div id="telop-ticker" class="ticker-text">
                    <span id="text-span-1"></span>
                    <span id="text-span-2"></span>
                    <span id="text-span-3"></span>
                </div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script>
        // ▼▼▼ あなたのFirebase設定 ▼▼▼
        const firebaseConfig = {
  apiKey: "AIzaSyAhsAbTqQuairo-82A9rxQTazUCGdzdVc4",
  authDomain: "obs-telop-system-7c98c.firebaseapp.com",
  databaseURL: "https://obs-telop-system-7c98c-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "obs-telop-system-7c98c",
  storageBucket: "obs-telop-system-7c98c.firebasestorage.app",
  messagingSenderId: "368503557333",
  appId: "1:368503557333:web:409dae2b1cf0c14b31a65c",
  measurementId: "G-VMBCJ2952Z"
};
        // ▲▲▲ ここまで ▲▲▲

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        const container = document.getElementById('telop-container');
        const telopHeader = document.getElementById('telop-header');
        const telopTicker = document.getElementById('telop-ticker'); // 親コンテナ
        const textSpan1 = document.getElementById('text-span-1');
        const textSpan2 = document.getElementById('text-span-2');
        const textSpan3 = document.getElementById('text-span-3');
        
        function adjustTextScaling() {
            telopTicker.style.transform = 'scaleX(1)';
            const containerWidth = telopTicker.parentElement.clientWidth;
            const textWidth = telopTicker.scrollWidth;

            if (textWidth > containerWidth) {
                const scale = containerWidth / textWidth;
                telopTicker.style.transform = `scaleX(${scale})`;
            }
        }

        database.ref('telop').on('value', (snapshot) => {
            const data = snapshot.val();

            if (data && data.visible) {
                // ヘッダーテキストと色を更新
                telopHeader.innerText = data.header || '';
                container.className = 'telop-container';
                container.classList.add(data.headerColor);

                // 各テキストと文字色を更新
                textSpan1.innerText = data.text1 || '';
                textSpan1.className = data.textColor1 || 'text-black';
                
                textSpan2.innerText = data.text2 || '';
                textSpan2.className = data.textColor2 || 'text-black';

                textSpan3.innerText = data.text3 || '';
                textSpan3.className = data.textColor3 || 'text-black';
                
                container.classList.add('visible');
                setTimeout(adjustTextScaling, 50);

            } else {
                container.classList.remove('visible');
            }
        });
    </script>
</body>
</html>